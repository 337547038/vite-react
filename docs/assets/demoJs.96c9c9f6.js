var Me=Object.defineProperty,Re=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ae=(s,d,u)=>d in s?Me(s,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[d]=u,S=(s,d)=>{for(var u in d||(d={}))Xe.call(d,u)&&ae(s,u,d[u]);if(le)for(var u of le(d))_e.call(d,u)&&ae(s,u,d[u]);return s},C=(s,d)=>Re(s,ze(d));import{r as a,a as i,c as b,j as B,F as qe,p as Ae}from"./index.449b2a60.js";import{C as ie}from"./Group.10e1bd32.js";import{d as ce}from"./index.4eedf3c9.js";import{a as $e}from"./dom.0e399110.js";import{P as Fe}from"./Pagination.d0e2f82c.js";import{T as Oe}from"./Tooltip.d1d3350e.js";const de=a.exports.forwardRef((s,d)=>{const{selectChecked:u=0}=s,[L,_]=a.exports.useState({}),Z=(c,r)=>{if(c===void 0){if(s.title)return r}else if(c)return r;return""},q=(c,r)=>{s.drag&&T("mouseMove",{evt:r,index:c})},w=(c,r)=>{T("mouseDown",{evt:r,index:c})},P=c=>{T("checkboxChange",c)},m=(c,r)=>{const p=C(S({},L),{[c]:r});_(p),T("sortClick",p)},T=(c,r)=>{s.event(c,r)},[A,$]=a.exports.useState({}),v=c=>{$(c?{transform:`translateY(${c}px) translateZ(100px)`,className:"transform"}:{transform:"",className:""})},M=()=>{_({})},y=c=>s.drag?c!==!1:!1;return a.exports.useImperativeHandle(d,()=>({scrollTop:v,clearSort:M})),i("thead",{style:{transform:A.transform},className:b(A.className),children:s.layer.map(c=>i("tr",{className:b({drag:s.drag}),children:s.columns.map((r,p)=>r._layer===c?B("th",{className:b(r.fixed,r.className),style:{textAlign:r.align},title:Z(r.title,r.label||""),colSpan:r._colSpan,rowSpan:r._rowSpan,onMouseMove:q.bind(globalThis,p),children:[r.type==="selection"?i(ie,{className:b({"some-select":u===2}),checked:u===1,onChange:P}):"",r.type!=="selection"?B(qe,{children:[r.label,r.sortBy?B("span",{className:"caret-wrapper",children:[i("i",{className:b("sort-caret asc icon-down",{active:L[r.prop]==="asc"}),onClick:()=>m(r.prop,"asc")}),i("i",{className:b("sort-caret desc icon-down",{active:L[r.prop]==="desc"}),onClick:()=>m(r.prop,"desc")})]}):""]}):"",y(r.drag)?i("a",{className:"drag-line",onMouseDown:w.bind(globalThis,p)}):""]},p):"")},c))})});de.displayName="TableHeader";const Ze=a.exports.forwardRef((s,d)=>{const{hover:u=!0,border:L=!0,stripe:_=!0,ellipsis:Z=!0,showHeader:q=!0,drag:w=!0,dragLine:P=!0,dragWidth:m=[60,0],title:T=!0,emptyText:A="\u6682\u65E0\u6570\u636E",pagination:$={}}=s,[v,M]=a.exports.useState({stateHeight:s.height||"",isSetThWidth:!1,mouseDown:!1}),[y,c]=a.exports.useState(s.data),[r,p]=a.exports.useState([]),G=a.exports.useRef(null),V=a.exports.useRef(null),f=a.exports.useRef(null);let F=0;const J=r.length;J===0?F=0:J===y.length?F=1:F=2;let O=0,K=[];const[ue,fe]=a.exports.useState([]),[Y,he]=a.exports.useState([]),[me,ge]=a.exports.useState([]),[R,I]=a.exports.useState([]),N=a.exports.useRef([]),Q=[],z=[],xe=ce(()=>{console.log("\u8868\u5934\u6570\u636E\u5904\u7406"),j(s.columns,0),he([...K]),I([...Q]),z.forEach(t=>{if(t.children){const n=z.filter(o=>{var h;const l=(h=o._tProps)==null?void 0:h.split(",");return l&&l.includes(t.prop)&&!o.children});(n==null?void 0:n.length)>0&&(t._colSpan=n.length)}else{const n=O-t._layer+1;n>1&&(t._rowSpan=n)}}),ge([...z]),console.log(z);const e=[];for(let t=0;t<O;t++)e.push(t+1);fe(e)}),j=(e,t=0,n="")=>{t++,t>O&&(O=t),e.forEach(o=>{const l=o.prop||"",h=n?n+","+l:l;o.children?j(o.children,t,h):(K.push(o),Q.push(o.width||"")),z.push(C(S({},o),{_layer:t,_tProps:h}))})},pe=(e,t,n)=>{console.log(e,n,t);let o=[];if(n)o=[...r,e];else{const l=r.indexOf(e);r.splice(l,1),o=r}p([...o]),s.selectClick&&s.selectClick(o,n,e,t)},ye=e=>r.includes(e),ee=e=>{p(e?[...y]:[])},Se=()=>r,ve=(e,t)=>{const n=r.indexOf(e);t?n===-1&&(r.push(e),p([...r])):n!==-1&&(r.splice(n,1),p([...r]))},be=()=>{var e;(e=V.current)==null||e.clearSort()},we=(e,t)=>{switch(e){case"checkboxChange":ee(t),s.selectClick&&s.selectClick(t?y:[],t);break;case"mouseDown":Ce(t);break;case"mouseMove":ke(t);break;case"sortClick":s.sortChange&&s.sortChange(t);break}},D=a.exports.useRef({}),Ce=e=>{if(!w)return;v.isSetThWidth||(Te(),document.addEventListener("mouseup",He));const t={isSetThWidth:!0,mouseDown:!0};M(S(S({},v),t));const n=R[e.index]||N.current[e.index];D.current={mouseDown:!0,oldX:e.evt.pageX,oldWidth:parseInt(n.replace("px",""),10)||0,index:e.index},te(e.evt),e.evt.preventDefault()},Te=()=>{var t;if(!w)return;const e=(t=f.current)==null?void 0:t.querySelectorAll("th");e&&(N.current=[],e.forEach(n=>{N.current.push(n.offsetWidth+"px")}),I([...N.current]))},te=e=>{setTimeout(()=>{var o;const t=$e(f.current);let n=(o=f.current)==null?void 0:o.querySelector(".table-drag-line");n&&(n.style.left=e.pageX-t.left+"px",n.style.height=t.height+"px")})},ke=e=>{var o,l,h;if(!w)return;const t=e.evt;let n=((o=D.current)==null?void 0:o.oldWidth)+(t.pageX-((l=D.current)==null?void 0:l.oldX));m[0]>0&&n<m[0]||m[1]>0&&n>m[1]||v.mouseDown&&(te(t),m[0]>0&&n<m[0]&&(n=m[0]),m[1]>0&&n>m[1]&&(n=m[1]),R[(h=D.current)==null?void 0:h.index]=n+"px",I([...R]),N.current=R)},He=()=>{var e;w&&((e=D.current)==null?void 0:e.mouseDown)&&s.dragChange&&s.dragChange(N.current),D.current={mouseDown:!1,oldX:void 0,oldWidth:void 0,index:void 0},M(C(S({},v),{mouseDown:!1}))};a.exports.useImperativeHandle(d,()=>({toggleSelection:ee,getSelectAll:Se,toggleRowSelection:ve,clearSort:be}));const Ne=(e,t,n)=>{if(!n)return"";if(e===void 0){if(T)return t}else if(e)return t;return""},De=ce(()=>{console.log("fixedHead"),setTimeout(()=>{se(0)},0)}),Ee=()=>{var e,t,n,o,l,h;if(s.height&&q&&f.current){const W=((e=f.current)==null?void 0:e.scrollTop)||0,H=((t=f.current)==null?void 0:t.scrollLeft)||0;(n=V.current)==null||n.scrollTop(W);const g=(o=f.current)==null?void 0:o.querySelectorAll(".left");if(g&&g.length>0)if(H>0)for(let x=0,X=g.length;x<X;x++)g[x].style.transform=`translateX(${H}px) translateZ(91px)`,g[x].style.webkitTransform=`translateX(${H}px) translateZ(91px)`;else for(let x=0,X=g.length;x<X;x++)g[x].style.transform="",g[x].style.webkitTransform="";if(se(H),typeof s.scroll=="function"){const x=(l=f.current)==null?void 0:l.clientHeight,X=(h=f.current)==null?void 0:h.scrollHeight;let re=!1;W+x>=X-3&&(re=!0),s.scroll(W,re)}}},se=e=>{var l,h,W,H;const t=(l=f.current)==null?void 0:l.querySelectorAll(".right"),n=((W=(h=f.current)==null?void 0:h.querySelector("table"))==null?void 0:W.offsetWidth)||0;let o=e-(n-(((H=f.current)==null?void 0:H.clientWidth)||0));if(t.length>0)for(let g=0,x=t.length;g<x;g++)t[g].style.transform=`translateX(${o}px)translateZ(90px)`,t[g].style.webkitTransform=`translateX(${o}px)translateZ(90px)`};a.exports.useEffect(()=>{xe()},[s.columns]),a.exports.useEffect(()=>{De()},[]),a.exports.useEffect(()=>{if(console.log("\u6570\u636E\u6539\u53D8"),ne({}),s.fixedBottomScroll){if(typeof s.fixedBottomScroll=="string"){const e=document.querySelector(s.fixedBottomScroll);e&&e.addEventListener("scroll",E)}else document.addEventListener("scroll",E);window.addEventListener("resize",E),setTimeout(()=>{E()},500)}return()=>{s.fixedBottomScroll&&(document.removeEventListener("scroll",E),window.removeEventListener("resize",E))}},[s.data]);const[k,ne]=a.exports.useState({}),We=(e,t)=>{k[e]===void 0?k[e]=!s.extendToggle:k[e]=!k[e],ne(S({},k)),s.hasChild&&typeof s.lazyLoad=="function"&&s.lazyLoad(t,n=>{t.children=n,c([...y])})},U=e=>k[e]===void 0?s.extendToggle||!1:k[e],E=()=>{if(console.log("scrollFixedBottom"),!s.fixedBottomScroll)return;const e=f.current,t=G.current;if(!e||!t)return;let n=window.innerHeight;if(typeof s.fixedBottomScroll=="string"){const l=document.querySelector(s.fixedBottomScroll);l&&(n=l.offsetHeight+20,console.log(n))}const{top:o}=e.getBoundingClientRect();if(o>n)e.style.height="unset",e.style.marginBottom="unset";else{const l=Math.min(n-o,t.offsetHeight);e.style.minHeight="60px",M(C(S({},v),{stateHeight:l+"px"})),e.style.marginBottom=t.offsetHeight-l+"px"}},Be=(e,t)=>{s.rowClick&&s.rowClick(e,t)},Le=(e,t,n,o)=>{s.cellClick&&s.cellClick(e,t,n,o)},oe=(e,t,n)=>i("tr",{onClick:()=>Be(e,t),children:Y.map((o,l)=>i("td",{className:b(o.fixed,o.className),title:Ne(o.title,e[o.prop],!o.tooltip),onClick:()=>Le(e,o,t,l),children:o.type==="selection"&&!n?i(ie,{checked:ye(e),onChange:pe.bind(globalThis,e,t)}):o.type==="index"?t+1:o.formatter?o.formatter(C(S({},e),{tExtend:n?void 0:We.bind(globalThis,t,e),tStatus:n?void 0:U(t)}),o,e[o.prop],t):i(Oe,C(S({direction:"top",disabled:!o.tooltip},o.tooltip),{content:e[o.prop],children:e[o.prop]}))},(o.prop||Math.floor(Math.random()*100))+t.toString()))},t);return B("div",{ref:f,className:b(Ae+"-table",s.className),style:{width:s.width,height:v.stateHeight,overflowY:s.height?"auto":void 0,overflowX:s.width?"auto":void 0},onScroll:Ee,children:[B("table",{ref:G,className:b({"no-stripe":!_,"no-border":!L,"no-hover":!u,"no-ellipsis":!Z}),children:[i("colgroup",{children:R.map((e,t)=>i("col",{width:e,className:`column${t}`},t))}),q?i(de,{ref:V,drag:w,title:T,layer:ue,selectChecked:F,columns:me,event:we}):"",i("tbody",{children:y.length===0?i("tr",{children:i("td",{colSpan:Y.length,className:"empty",children:A})}):y.map((e,t)=>B(a.exports.Fragment,{children:[oe(e,t),typeof s.expandable=="function"&&U(t)?i("tr",{className:"extend-row",children:i("td",{colSpan:Y.length,children:s.expandable(e)})},"extend"+t):"",s.hasChild&&e.children&&U(t)?e.children.map((n,o)=>oe(n,o,!0)):""]},t))})]}),P&&w&&v.mouseDown?i("div",{className:"table-drag-line"}):"",Object.keys($).length>0?i(Fe,C(S({},s.pagination),{total:y==null?void 0:y.length})):""]})});Ze.displayName="Table";var Ke=[{date:"2016-05-03",name:"\u5F20\u4E09",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537",children:[{date:"2016-05-00",name:"\u5B50\u7EA7",province:"\u5B50\u7EA7\u5E7F\u4E1C",city:"\u5B50\u7EA7\u767D\u4E91\u533A",address:"\u5B50\u7EA7\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:0}]},{date:"2016-05-04",name:"\u674E\u56DB",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537"},{date:"2016-05-05",name:"\u674E\u56DB5",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-06",name:"\u674E\u56DB6",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537"},{date:"2016-05-07",name:"\u674E\u56DB7",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-08",name:"\u674E\u56DB8",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-09",name:"\u674E\u56DB9",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-10",name:"\u674E\u56DB10",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"}];export{Ze as T,Ke as t};
