import{r as n,j as d,c as v,p as E}from"./index-eab8b3d4.js";import{a as V}from"./contextForm-cfeffa56.js";import{o as j}from"./index-a427ff8b.js";const N=n.forwardRef((e,m)=>{const o=n.useContext(V),l=o.disabled||e.disabled,i=()=>{let c=!1;return typeof e.checked=="boolean"?c=e.checked:e.value&&e.checked&&(c=e.checked.includes(e.value)),c},[u,C]=n.useState(i());n.useEffect(()=>{C(i())},[e.checked]);const g=()=>{if(e.beforeChange&&!e.beforeChange()||l)return;C(!u);const c=a(!u);e.onChange&&e.onChange(c),o.controlChange&&o.controlChange(c,"change")},a=c=>{let f=u;return c!==void 0&&(f=c),e.value?f?e.value:!1:f};return n.useImperativeHandle(m,()=>({getValue:a})),d.jsx("label",{className:v(e.className,{[E+"-checkbox"]:!0,checked:u,disabled:l}),onClick:g,children:d.jsxs("span",{children:[d.jsx("span",{className:v("checkbox-inner icon-check",{checked:u})}),e.children?d.jsx("span",{className:"checkbox-text",children:e.children}):d.jsx("span",{className:"checkbox-text",children:e.label})]})})});N.displayName="Checkbox";N.defaultProps={};const L=n.forwardRef((e,m)=>{const{options:o=[],optionsKey:l={label:"label",value:"value"},max:i=0,min:u=0}=e,[C,g]=n.useState(e.defaultValue||[]),a=n.useRef(C),[c,f]=n.useState({}),k=n.useContext(V).disabled||e.disabled,y=(s,r)=>{if(k)return!1;if(r)a.current.push(r);else{let t=-1;for(const x in a.current)if(t++,a.current[x]===s[l.value]){a.current.splice(t,1);break}}const h=a.current.length;let b={};h>=i&&i>0&&e.options.forEach((t,x)=>{a.current.includes(t[l.value])||(b[x]=!0)}),h<=u&&u>0&&e.options.forEach((t,x)=>{a.current.includes(t[l.value])&&(b[x]=!0)}),f(b),e.onChange&&e.onChange(a.current)},I=()=>a.current,F=s=>{if(k||e.beforeChange&&!e.beforeChange())return!1;let r={};o.forEach((h,b)=>{const t=h[l.value];s?!h.disabled&&!a.current.includes(t)&&(i>0?a.current.length<i?a.current.push(t):r[b]=!0:a.current.push(t)):!h.disabled&&a.current.includes(t)&&(u>0?a.current.length>u?a.current=j(a.current,[t]):r[b]=!0:a.current=j(a.current,[t]))}),Object.keys(r).length>0&&f(r),g([...a.current])};return n.useImperativeHandle(m,()=>({getValue:I,toggleSelect:F})),n.useEffect(()=>{g([...e.defaultValue||[]])},[e.defaultValue]),d.jsx("div",{className:v(`${E}-checkbox-group`,e.className),children:o.map((s,r)=>d.jsx(N,{value:s[l.value],checked:C.includes(s[l.value]),label:s[l.label]||s[l.value],disabled:k||c[r]||s.disabled,className:s.class,beforeChange:e.beforeChange,onChange:y.bind(void 0,s)},r))})});L.displayName="CheckboxGroup";export{N as C,L as a};
