var _=Object.defineProperty;var z=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var M=(e,c,s)=>c in e?_(e,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[c]=s,m=(e,c)=>{for(var s in c||(c={}))ee.call(c,s)&&M(e,s,c[s]);if(z)for(var s of z(c))te.call(c,s)&&M(e,s,c[s]);return e};import{r as a,p,j as r,c as u,a as o,F as ne,b as le}from"./index.efbe83c6.js";import{a as ie}from"./contextForm.e282e2fd.js";import{T as oe}from"./Tag.8e9f54c3.js";import{g as ae,a as se}from"./dom.46b1a4a1.js";const Y=a.exports.forwardRef((e,c)=>{const{defaultValue:s=[]}=e,[n,g]=a.exports.useState(s),[S,B]=a.exports.useState(e.direction||0),[x,v]=a.exports.useState(Object.assign({},e.downStyle,{display:"none"})),d=a.exports.useContext(ie).disabled||e.disabled,k=a.exports.useRef(null),E=a.exports.useRef(null),[L,D]=a.exports.useState("");a.exports.useEffect(()=>{g([...s])},[e.defaultValue]);let I={};e.downHeight&&(I={maxHeight:e.downHeight+"px",overflowY:"auto"});const H=a.exports.useRef(!1),h=a.exports.useRef(!1),W=t=>{d||($(t),U(!0),H.current=!0,h.current=!0,e.toggleClick&&e.toggleClick(!0,t),setTimeout(()=>{H.current=!1},100))},$=t=>{var l;if(e.direction===0){B(e.direction);const i=document.documentElement.clientHeight||document.body.clientHeight,f=t.clientY;let N=e.downHeight||((l=E.current)==null?void 0:l.offsetHeight)||0;N>i-f&&f>N&&B(2)}},U=t=>{if(!k.current)return;let l={};const i=ae(k.current);if(e.appendToBody){const N=se();l={bottom:"auto",minWidth:i.width+"px",left:i.left+"px",top:i.top+i.height+8+"px"},S===2&&(l.top="auto",l.bottom=N.height-i.top+"px")}else l.top=i.height+8+"px",l.bottom="auto",S===2&&(l.bottom=i.height+8+"px",l.top="auto");const f={display:t?"":"none"};v(m(m(m({},x),l),f)),O(t)},q=t=>{h.current&&!e.filterable&&(w(t),t.stopPropagation())},w=t=>{h.current&&!H.current&&(t&&e.toggleClick&&e.toggleClick(!1,t),O(!1),h.current=!1)},O=t=>{let l="slide-toggle-leave-active";t&&(l="slide-toggle-enter-active"),D(l),setTimeout(()=>{if(!t){const i={display:"none"};v(m(m({},x),i))}D("")},400)},C=(t,l)=>{let i=l.target.value;t==="normal"&&g([i]),t==="start"&&(n[0]=i,g([...n])),t==="end"&&(n[1]=i,g([...n])),P(l,"onInput",t)},T=(t,l)=>{P(l,"onFocus",t)},y=(t,l)=>{P(l,"onBlur",t)},P=(t,l,i)=>{if(e.filterable){let f=t.target.value;e[l]&&e[l](f,i,t)}},V=(t,l)=>{n.splice(t,1),g([...n]),e.onDelete&&e.onDelete(t),l.stopPropagation()},G=t=>{g([]),A(),t.stopPropagation(),e.onClear&&e.onClear()},J=t=>{t.stopPropagation()};a.exports.useEffect(()=>(document.addEventListener("click",w,!1),()=>{document.removeEventListener("click",w,!1)}),[x]);const K=()=>n,b=a.exports.useRef(null),F=a.exports.useRef(null),A=()=>{e.filterable&&(b.current&&(b.current.value=""),F.current&&(F.current.value=""))};a.exports.useImperativeHandle(c,()=>({getValue:K,clearValue:A,slideUp:w}));const R={[`${p}-input-control`]:!0,[e.size]:e.size,disabled:d},Q=r("div",{className:u("select-range",R),children:[o("input",{ref:b,value:n[0]||"",readOnly:!e.filterable,placeholder:e.placeholder,disabled:d,onChange:C.bind(globalThis,"start"),onFocus:T.bind(globalThis,"start"),onBlur:y.bind(globalThis,"start")},"start"),o("span",{children:e.rangeSeparator}),o("input",{ref:F,value:n[1]||"",readOnly:!e.filterable,placeholder:e.endPlaceholder,disabled:d,onChange:C.bind(globalThis,"end"),onFocus:T.bind(globalThis,"start"),onBlur:y.bind(globalThis,"start")},"end")]}),X=o("div",{className:u("multiple-text",R),children:r("ul",{placeholder:e.placeholder,children:[e.collapseTags?r(a.exports.Fragment,{children:[(n==null?void 0:n.length)>0?r("li",{children:[o("span",{children:n[0]}),o("i",{className:"icon-error",onClick:V.bind(globalThis,0)})]}):"",(n==null?void 0:n.length)>1?o("li",{children:r(oe,{size:"mini",type:"info",children:[" +",n==null?void 0:n.length]})}):""]}):o(ne,{children:n.map((t,l)=>r("li",{children:[o("span",{children:t}),o("i",{className:"icon-error",onClick:V.bind(globalThis,l)})]},t))}),e.filterable?o("li",{className:"input",children:o("input",{ref:b,type:"text",disabled:d,placeholder:(n==null?void 0:n.length)===0?e.placeholder:"",onChange:C.bind(globalThis,"multiple"),onFocus:T.bind(globalThis,"multiple"),onBlur:y.bind(globalThis,"multiple")})}):""]})}),Z=o("input",{ref:b,value:(n==null?void 0:n.length)>0?n[0]:"",readOnly:!e.filterable,placeholder:e.placeholder,className:u(R),disabled:d,onChange:C.bind(globalThis,"normal"),onFocus:T.bind(globalThis,"normal"),onBlur:y.bind(globalThis,"normal")}),j=r("div",{ref:E,className:u(e.className,L,{[p+"-select-down-pane"]:!0,[e.downClass]:e.downClass,top:S===2}),style:x,onClick:J,children:[o("div",{style:I,className:"scroll-pane",children:e.children}),o("span",{className:u("down-arrow",{"is-range":e.isRange})})]});return r("div",{ref:k,className:u({"is-down":h.current,[p+"-select-down"]:!0,disabled:d}),onClick:W,style:{width:e.width},children:[r("div",{className:"select-control",onClick:q,children:[e.isRange?Q:e.multiple?X:Z,r("span",{className:"group-icon",children:[e.clear&&(n==null?void 0:n.length)>0?o("i",{className:"icon-close",title:"\u6E05\u7A7A",onClick:G}):"",o("i",{className:u({down:h.current&&!e.fixedIcon,[`icon-${e.icon}`]:!0})})]})]}),e.appendToBody?le.createPortal(j,document.body):j]})});Y.displayName="SelectDown";Y.defaultProps={icon:"arrow",rangeSeparator:"To",direction:0,downHeight:0,appendToBody:!1};export{Y as S};
