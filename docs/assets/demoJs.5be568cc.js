var Me=Object.defineProperty,ze=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ae=(n,d,u)=>d in n?Me(n,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):n[d]=u,S=(n,d)=>{for(var u in d||(d={}))_e.call(d,u)&&ae(n,u,d[u]);if(le)for(var u of le(d))qe.call(d,u)&&ae(n,u,d[u]);return n},v=(n,d)=>ze(n,Xe(d));import{r as a,a as i,c as b,j as B,F as Ae,p as $e}from"./index.d9b65b5e.js";import{C as ie}from"./Group.b46e9ddf.js";import{d as ce}from"./index.4eedf3c9.js";import{a as Oe}from"./dom.0e399110.js";import{P as Ze}from"./Pagination.d67c585c.js";import{T as Fe}from"./Tooltip.c11dd891.js";const de=a.exports.forwardRef((n,d)=>{const{selectChecked:u=0}=n,[L,X]=a.exports.useState({}),F=(c,r)=>{if(c===void 0){if(n.title)return r}else if(c)return r;return""},_=(c,r)=>{n.drag&&k("mouseMove",{evt:r,index:c})},C=(c,r)=>{k("mouseDown",{evt:r,index:c})},P=c=>{k("checkboxChange",c)},g=(c,r)=>{const x=v(S({},L),{[c]:r});X(x),k("sortClick",x)},k=(c,r)=>{n.event(c,r)},[q,A]=a.exports.useState({}),w=c=>{A(c?{transform:`translateY(${c}px) translateZ(100px)`,className:"transform"}:{transform:"",className:""})},R=()=>{X({})},y=c=>n.drag?c!==!1:!1;return a.exports.useImperativeHandle(d,()=>({scrollTop:w,clearSort:R})),i("thead",{style:{transform:q.transform},className:b(q.className),children:n.layer.map(c=>i("tr",{className:b({drag:n.drag}),children:n.columns.map((r,x)=>r._layer===c?B("th",{className:b(r.fixed,r.className),style:{textAlign:r.align},title:F(r.title,r.label||""),colSpan:r._colSpan,rowSpan:r._rowSpan,onMouseMove:_.bind(globalThis,x),children:[r.type==="selection"?i(ie,{className:b({"some-select":u===2}),checked:u===1,onChange:P}):"",r.type!=="selection"?B(Ae,{children:[r.label,r.sortBy?B("span",{className:"caret-wrapper",children:[i("i",{className:b("sort-caret asc icon-down",{active:L[r.prop]==="asc"}),onClick:()=>g(r.prop,"asc")}),i("i",{className:b("sort-caret desc icon-down",{active:L[r.prop]==="desc"}),onClick:()=>g(r.prop,"desc")})]}):""]}):"",y(r.drag)?i("a",{className:"drag-line",onMouseDown:C.bind(globalThis,x)}):""]},x):"")},c))})});de.displayName="TableHeader";const Pe=a.exports.forwardRef((n,d)=>{const{hover:u=!0,border:L=!0,stripe:X=!0,ellipsis:F=!0,showHeader:_=!0,drag:C=!0,dragLine:P=!0,dragWidth:g=[60,0],title:k=!0,emptyText:q="\u6682\u65E0\u6570\u636E",pagination:A={}}=n,[w,R]=a.exports.useState({stateHeight:n.height||"",isSetThWidth:!1,mouseDown:!1}),[y,c]=a.exports.useState(n.data),[r,x]=a.exports.useState([]),I=a.exports.useRef(null),V=a.exports.useRef(null),f=a.exports.useRef(null);let $=0;const J=r.length;J===0?$=0:J===y.length?$=1:$=2;let O=0,K=[];const[ue,fe]=a.exports.useState([]),[Y,he]=a.exports.useState([]),[ge,me]=a.exports.useState([]),[M,U]=a.exports.useState([]),N=a.exports.useRef([]),Q=[],Z=[],pe=ce(()=>{console.log("\u8868\u5934\u6570\u636E\u5904\u7406"),j(n.columns,0),he([...K]),U([...Q]),Z.forEach(t=>{if(t.children){const o=Z.filter(s=>{var h;const l=(h=s._tProps)==null?void 0:h.split(",");return l&&l.includes(t.prop)&&!s.children});(o==null?void 0:o.length)>0&&(t._colSpan=o.length)}else{const o=O-t._layer+1;o>1&&(t._rowSpan=o)}}),me([...Z]);const e=[];for(let t=0;t<O;t++)e.push(t+1);fe(e)}),j=(e,t=0,o="")=>{t++,t>O&&(O=t),e.forEach(s=>{const l=s.prop||"",h=o?o+","+l:l;s.children?j(s.children,t,h):(K.push(s),Q.push(s.width||"")),Z.push(v(S({},s),{_layer:t,_tProps:h}))})},xe=(e,t,o)=>{let s=[];if(o)s=[...r,e];else{const l=r.indexOf(e);r.splice(l,1),s=r}x([...s]),n.selectClick&&n.selectClick(s,o,e,t)},Se=e=>r.includes(e),ee=e=>{x(e?[...y]:[])},ye=()=>r,we=(e,t)=>{const o=r.indexOf(e);t?o===-1&&(r.push(e),x([...r])):o!==-1&&(r.splice(o,1),x([...r]))},ve=()=>{var e;(e=V.current)==null||e.clearSort()},be=(e,t)=>{switch(e){case"checkboxChange":ee(t),n.selectClick&&n.selectClick(t?y:[],t);break;case"mouseDown":Ce(t);break;case"mouseMove":Te(t);break;case"sortClick":n.sortChange&&n.sortChange(t);break}},E=a.exports.useRef({}),Ce=e=>{if(!C)return;w.isSetThWidth||(ke(),document.addEventListener("mouseup",He));const t={isSetThWidth:!0,mouseDown:!0};R(S(S({},w),t));const o=M[e.index]||N.current[e.index];E.current={mouseDown:!0,oldX:e.evt.pageX,oldWidth:parseInt(o.replace("px",""),10)||0,index:e.index},te(e.evt),e.evt.preventDefault()},ke=()=>{var t;if(!C)return;const e=(t=f.current)==null?void 0:t.querySelectorAll("th");e&&(N.current=[],e.forEach(o=>{N.current.push(o.offsetWidth+"px")}),U([...N.current]))},te=e=>{setTimeout(()=>{var s;const t=Oe(f.current);let o=(s=f.current)==null?void 0:s.querySelector(".table-drag-line");o&&(o.style.left=e.pageX-t.left+"px",o.style.height=t.height+"px")})},Te=e=>{var s,l,h;if(!C)return;const t=e.evt;let o=((s=E.current)==null?void 0:s.oldWidth)+(t.pageX-((l=E.current)==null?void 0:l.oldX));g[0]>0&&o<g[0]||g[1]>0&&o>g[1]||w.mouseDown&&(te(t),g[0]>0&&o<g[0]&&(o=g[0]),g[1]>0&&o>g[1]&&(o=g[1]),M[(h=E.current)==null?void 0:h.index]=o+"px",U([...M]),N.current=M)},He=()=>{var e;C&&((e=E.current)==null?void 0:e.mouseDown)&&n.dragChange&&n.dragChange(N.current),E.current={mouseDown:!1,oldX:void 0,oldWidth:void 0,index:void 0},R(v(S({},w),{mouseDown:!1}))};a.exports.useImperativeHandle(d,()=>({toggleSelection:ee,getSelectAll:ye,toggleRowSelection:we,clearSort:ve}));const Ne=(e,t,o)=>{if(!o)return"";if(e===void 0){if(k)return t}else if(e)return t;return""},Ee=ce(()=>{console.log("fixedHead"),setTimeout(()=>{ne(0)},0)}),De=()=>{var e,t,o,s,l,h;if(n.height&&_&&f.current){const W=((e=f.current)==null?void 0:e.scrollTop)||0,H=((t=f.current)==null?void 0:t.scrollLeft)||0;(o=V.current)==null||o.scrollTop(W);const m=(s=f.current)==null?void 0:s.querySelectorAll(".left");if(m&&m.length>0)if(H>0)for(let p=0,z=m.length;p<z;p++)m[p].style.transform=`translateX(${H}px) translateZ(91px)`,m[p].style.webkitTransform=`translateX(${H}px) translateZ(91px)`;else for(let p=0,z=m.length;p<z;p++)m[p].style.transform="",m[p].style.webkitTransform="";if(ne(H),typeof n.scroll=="function"){const p=(l=f.current)==null?void 0:l.clientHeight,z=(h=f.current)==null?void 0:h.scrollHeight;let re=!1;W+p>=z-3&&(re=!0),n.scroll(W,re)}}},ne=e=>{var l,h,W,H;const t=(l=f.current)==null?void 0:l.querySelectorAll(".right"),o=((W=(h=f.current)==null?void 0:h.querySelector("table"))==null?void 0:W.offsetWidth)||0;let s=e-(o-(((H=f.current)==null?void 0:H.clientWidth)||0));if(t.length>0)for(let m=0,p=t.length;m<p;m++)t[m].style.transform=`translateX(${s}px)translateZ(90px)`,t[m].style.webkitTransform=`translateX(${s}px)translateZ(90px)`};a.exports.useEffect(()=>{pe()},[n.columns]),a.exports.useEffect(()=>{Ee()},[]),a.exports.useEffect(()=>{if(console.log("\u6570\u636E\u6539\u53D8"),se({}),c([...n.data]),n.fixedBottomScroll){if(typeof n.fixedBottomScroll=="string"){const e=document.querySelector(n.fixedBottomScroll);e&&e.addEventListener("scroll",D)}else document.addEventListener("scroll",D);window.addEventListener("resize",D),setTimeout(()=>{D()},500)}return()=>{n.fixedBottomScroll&&(document.removeEventListener("scroll",D),window.removeEventListener("resize",D))}},[n.data]);const[T,se]=a.exports.useState({}),We=(e,t)=>{T[e]===void 0?T[e]=!n.extendToggle:T[e]=!T[e],se(S({},T)),n.hasChild&&typeof n.lazyLoad=="function"&&n.lazyLoad(t,o=>{t.children=o,c([...y])})},G=e=>T[e]===void 0?n.extendToggle||!1:T[e],D=()=>{if(!n.fixedBottomScroll)return;const e=f.current,t=I.current;if(!e||!t)return;let o=window.innerHeight;if(typeof n.fixedBottomScroll=="string"){const l=document.querySelector(n.fixedBottomScroll);l&&(o=l.offsetHeight+20)}const{top:s}=e.getBoundingClientRect();if(s>o)e.style.height="unset",e.style.marginBottom="unset";else{const l=Math.min(o-s,t.offsetHeight);e.style.minHeight="60px",R(v(S({},w),{stateHeight:l+"px"})),e.style.marginBottom=t.offsetHeight-l+"px"}},Be=(e,t)=>{n.rowClick&&n.rowClick(e,t)},Le=(e,t,o,s)=>{n.cellClick&&n.cellClick(e,t,o,s)},Re=(e,t)=>{let o={};return n.rowColSpan&&n.rowColSpan.forEach(s=>{e===s.row&&t===s.col&&(s.rowSpan===0||s.colSpan===0?o.style={display:"none"}:(s.rowSpan&&s.rowSpan>1&&(o.rowSpan=s.rowSpan),s.colSpan&&s.colSpan>1&&(o.colSpan=s.colSpan)))}),o},oe=(e,t,o)=>i("tr",{onClick:()=>Be(e,t),children:Y.map((s,l)=>a.exports.createElement("td",v(S({},Re(t,l)),{className:b(s.fixed,s.className),key:(s.prop||Math.floor(Math.random()*100))+t.toString(),title:Ne(s.title,e[s.prop],!s.tooltip),onClick:()=>Le(e,s,t,l)}),s.type==="selection"&&!o?i(ie,{checked:Se(e),onChange:xe.bind(globalThis,e,t)}):s.type==="index"?t+1:s.formatter?s.formatter(v(S({},e),{tExtend:o?void 0:We.bind(globalThis,t,e),tStatus:o?void 0:G(t)}),s,e[s.prop],t):i(Fe,v(S({direction:"top",disabled:!s.tooltip},s.tooltip),{content:e[s.prop],children:e[s.prop]}))))},t);return B("div",{ref:f,className:b($e+"-table",n.className),style:{width:n.width,height:w.stateHeight,overflowY:n.height?"auto":void 0,overflowX:n.width?"auto":void 0},onScroll:De,children:[B("table",{ref:I,className:b({"no-stripe":!X,"no-border":!L,"no-hover":!u,"no-ellipsis":!F}),children:[i("colgroup",{children:M.map((e,t)=>i("col",{width:e,className:`column${t}`},t))}),_?i(de,{ref:V,drag:C,title:k,layer:ue,selectChecked:$,columns:ge,event:be}):"",i("tbody",{children:y.length===0?i("tr",{children:i("td",{colSpan:Y.length,className:"empty",children:q})}):y.map((e,t)=>B(a.exports.Fragment,{children:[oe(e,t),typeof n.expandable=="function"&&G(t)?i("tr",{className:"extend-row",children:i("td",{colSpan:Y.length,children:n.expandable(e)})},"extend"+t):"",n.hasChild&&e.children&&G(t)?e.children.map((o,s)=>oe(o,s,!0)):""]},t))})]}),P&&C&&w.mouseDown?i("div",{className:"table-drag-line"}):"",Object.keys(A).length>0?i(Ze,v(S({},n.pagination),{total:y==null?void 0:y.length})):""]})});Pe.displayName="Table";var Qe=[{date:"2016-05-03",name:"\u5F20\u4E09",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537",children:[{date:"2016-05-00",name:"\u5B50\u7EA7",province:"\u5B50\u7EA7\u5E7F\u4E1C",city:"\u5B50\u7EA7\u767D\u4E91\u533A",address:"\u5B50\u7EA7\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:0}]},{date:"2016-05-04",name:"\u674E\u56DB",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537"},{date:"2016-05-05",name:"\u674E\u56DB5",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-06",name:"\u674E\u56DB6",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u7537"},{date:"2016-05-07",name:"\u674E\u56DB7",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-08",name:"\u674E\u56DB8",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-09",name:"\u674E\u56DB9",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"},{date:"2016-05-10",name:"\u674E\u56DB10",province:"\u5E7F\u4E1C",city:"\u767D\u4E91\u533A",address:"\u5E7F\u4E1C\u7701\u5E7F\u5DDE\u5E02\u767D\u4E91\u533A\u65E0\u540D\u8DEF888\u53F7",zip:200330,sex:"\u5973"}];export{Pe as T,Qe as t};
