var _=Object.defineProperty;var z=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var M=(e,c,s)=>c in e?_(e,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[c]=s,h=(e,c)=>{for(var s in c||(c={}))ee.call(c,s)&&M(e,s,c[s]);if(z)for(var s of z(c))te.call(c,s)&&M(e,s,c[s]);return e};import{r as a,p as R,j as r,c as u,a as i,F as ne,b as le}from"./index.95d8ce5f.js";import{a as oe}from"./contextForm.cd12c54d.js";import{T as ie}from"./Tag.6cabb634.js";import{a as ae,b as se}from"./dom.0e399110.js";const Y=a.exports.forwardRef((e,c)=>{const{defaultValue:s=[]}=e,[n,f]=a.exports.useState(s),[S,B]=a.exports.useState(e.direction||0),[x,v]=a.exports.useState(Object.assign({},e.downStyle,{display:"none"})),d=a.exports.useContext(oe).disabled||e.disabled,k=a.exports.useRef(null),I=a.exports.useRef(null),[L,E]=a.exports.useState("");a.exports.useEffect(()=>{f([...s])},[e.defaultValue]);let D={};e.downHeight&&(D={maxHeight:e.downHeight+"px",overflowY:"auto"});const H=a.exports.useRef(!1),g=a.exports.useRef(!1),W=t=>{d||($(t),U(!0),H.current=!0,g.current=!0,e.toggleClick&&e.toggleClick(!0,t),setTimeout(()=>{H.current=!1},100))},$=t=>{var l;if(e.direction===0){B(e.direction);const o=document.documentElement.clientHeight||document.body.clientHeight,T=t.clientY;let N=e.downHeight||((l=I.current)==null?void 0:l.offsetHeight)||0;N>o-T&&T>N&&B(2)}},U=t=>{if(!k.current)return;let l={};const o=ae(k.current);if(e.appendToBody){const N=se();l={bottom:"auto",minWidth:o.width+"px",left:o.left+"px",top:o.top+o.height+8+"px"},S===2&&(l.top="auto",l.bottom=N.height-o.top+"px")}else l.top=o.height+8+"px",l.bottom="auto",S===2&&(l.bottom=o.height+8+"px",l.top="auto");const T={display:t?"":"none"};v(h(h(h({},x),l),T)),O(t)},q=t=>{g.current&&!e.filterable&&(b(t),t.stopPropagation())},b=t=>{g.current&&!H.current&&(t&&e.toggleClick&&e.toggleClick(!1,t),O(!1),g.current=!1)},O=t=>{let l="slide-toggle-leave-active";t&&(l="slide-toggle-enter-active"),E(l),setTimeout(()=>{if(!t){const o={display:"none"};v(h(h({},x),o))}E("")},400)},w=(t,l)=>{let o=l.target.value;t==="normal"&&f([o]),t==="start"&&(n[0]=o,f([...n])),t==="end"&&(n[1]=o,f([...n])),P(l,"onInput")},C=t=>{P(t,"onFocus")},y=t=>{P(t,"onBlur")},P=(t,l)=>{if(e.filterable){let o=t.target.value;e[l]&&e[l](o,n,t)}},V=(t,l)=>{n.splice(t,1),f([...n]),e.onDelete&&e.onDelete(t),l.stopPropagation()},G=t=>{f([]),A(),e.onInput&&e.onInput("",[]),t.stopPropagation()},J=t=>{t.stopPropagation()};a.exports.useEffect(()=>(document.addEventListener("click",b,!1),()=>{document.removeEventListener("click",b,!1)}),[x]);const K=()=>n,m=a.exports.useRef(null),F=a.exports.useRef(null),A=()=>{e.filterable&&(m.current&&(m.current.value=""),F.current&&(F.current.value=""))};a.exports.useImperativeHandle(c,()=>({getValue:K,clearValue:A,slideUp:b}));const p={[`${R}-input-control`]:!0,[e.size]:e.size,disabled:d},Q=r("div",{className:u("select-range",p),children:[i("input",{ref:m,value:n[0],readOnly:!e.filterable,placeholder:e.placeholder,disabled:d,onChange:w.bind(globalThis,"start"),onFocus:C,onBlur:y},"start"),i("span",{children:e.rangeSeparator}),i("input",{ref:F,value:n[1],readOnly:!e.filterable,placeholder:e.endPlaceholder,disabled:d,onChange:w.bind(globalThis,"end"),onFocus:C,onBlur:y},"end")]}),X=i("div",{className:u("multiple-text",p),children:r("ul",{placeholder:e.placeholder,children:[e.collapseTags?r(a.exports.Fragment,{children:[(n==null?void 0:n.length)>0?r("li",{children:[i("span",{children:n[0]}),i("i",{className:"icon-error",onClick:V.bind(globalThis,0)})]}):"",(n==null?void 0:n.length)>1?i("li",{children:r(ie,{size:"mini",type:"info",children:[" +",n==null?void 0:n.length]})}):""]}):i(ne,{children:n.map((t,l)=>r("li",{children:[i("span",{children:t}),i("i",{className:"icon-error",onClick:V.bind(globalThis,l)})]},t))}),e.filterable?i("li",{className:"input",children:i("input",{ref:m,type:"text",disabled:d,placeholder:(n==null?void 0:n.length)===0?e.placeholder:"",onChange:w.bind(globalThis,"multiple"),onFocus:C,onBlur:y})}):""]})}),Z=i("input",{ref:m,value:(n==null?void 0:n.length)>0?n[0]:"",readOnly:!e.filterable,placeholder:e.placeholder,className:u(p),disabled:d,onChange:w.bind(globalThis,"normal"),onFocus:C,onBlur:y}),j=r("div",{ref:I,className:u(e.className,L,{[R+"-select-down-pane"]:!0,[e.downClass]:e.downClass,top:S===2}),style:x,onClick:J,children:[i("div",{style:D,className:"scroll-pane",children:e.children}),i("span",{className:u("down-arrow",{"is-range":e.isRange})})]});return r("div",{ref:k,className:u({"is-down":g.current,[R+"-select-down"]:!0,disabled:d}),onClick:W,style:{width:e.width},children:[r("div",{className:"select-control",onClick:q,children:[e.isRange?Q:e.multiple?X:Z,r("span",{className:"group-icon",children:[e.clear&&(n==null?void 0:n.length)>0?i("i",{className:"icon-close",title:"\u6E05\u7A7A",onClick:G}):"",i("i",{className:u({down:g.current&&!e.fixedIcon,[`icon-${e.icon}`]:!0})})]})]}),e.appendToBody?le.createPortal(j,document.body):j]})});Y.displayName="SelectDown";Y.defaultProps={icon:"arrow",rangeSeparator:"To",direction:0,downHeight:0,appendToBody:!1};export{Y as S};
